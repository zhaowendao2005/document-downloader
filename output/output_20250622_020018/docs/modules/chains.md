---
url: https://js.langchain.com.cn/docs/modules/chains/
crawled_at: 2025-06-22T02:00:21.004898
---

å…¥é—¨æŒ‡å—: é“¾
info
æ¦‚å¿µæŒ‡å—
åœ¨ä¸€äº›åº”ç”¨ä¸­ï¼Œä»…ä½¿ç”¨ä¸€ä¸ªè¯­è¨€æ¨¡å‹æ˜¯å¯ä»¥çš„ï¼Œä½†é€šå¸¸å°†è¯­è¨€æ¨¡å‹ä¸å…¶ä»–ä¿¡æ¯æºï¼ˆä¾‹å¦‚ç¬¬ä¸‰æ–¹APIæˆ–å…¶ä»–è¯­è¨€æ¨¡å‹)ç»„åˆä½¿ç”¨æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚
è¿™å°±æ˜¯é“¾çš„æ¦‚å¿µã€‚
LangChainæä¾›äº†ä¸€ä¸ªç”¨äºé“¾çš„æ ‡å‡†æ¥å£ï¼Œä»¥åŠä¸€äº›å¯ç›´æ¥ä½¿ç”¨çš„å†…ç½®é“¾ã€‚æ‚¨ä¹Ÿå¯ä»¥åˆ›å»ºè‡ªå·±çš„é“¾ã€‚
ğŸ“„ï¸
LLMé“¾
æ¦‚å¿µæŒ‡å—
ğŸ—ƒï¸
ä¸ç´¢å¼•ç›¸å…³çš„é“¾
3 items
ğŸ“„ï¸
é¡ºåºé“¾
é¡ºåºé“¾å…è®¸æ‚¨è¿æ¥å¤šä¸ªé“¾ï¼Œå¹¶å°†å®ƒä»¬ç»„åˆæˆæ‰§è¡Œç‰¹å®šåœºæ™¯çš„ç®¡é“ã€‚
ğŸ—ƒï¸
å…¶ä»–é“¾
8 items
ğŸ“„ï¸
æç¤ºé€‰æ‹©å™¨
æ¦‚å¿µæŒ‡å—
é«˜çº§
â€‹
è¦å®ç°è‡ªå·±çš„è‡ªå®šä¹‰é“¾ï¼Œæ‚¨å¯ä»¥ç»§æ‰¿
BaseChain
å¹¶å®ç°ä»¥ä¸‹æ–¹æ³•:
import
{
CallbackManagerForChainRun
}
from
"langchain/callbacks"
;
import
{
BaseChain
as
_
}
from
"langchain/chains"
;
import
{
BaseMemory
}
from
"langchain/memory"
;
import
{
ChainValues
}
from
"langchain/schema"
;
abstract
class
BaseChain
{
memory
?
:
BaseMemory
;
/**
* Run the core logic of this chain and return the output
*/
abstract
_call
(
values
:
ChainValues
,
runManager
?
:
CallbackManagerForChainRun
)
:
Promise
<
ChainValues
>
;
/**
* Return the string type key uniquely identifying this class of chain.
*/
abstract
_chainType
(
)
:
string
;
/**
* Return the list of input keys this chain expects to receive when called.
*/
abstract
get
inputKeys
(
)
:
string
[
]
;
/**
* Return the list of output keys this chain will produce when called.
*/
abstract
get
outputKeys
(
)
:
string
[
]
;
}
ç»§æ‰¿
BaseChain
â€‹
_call
æ–¹æ³•æ˜¯è‡ªå®šä¹‰é“¾å¿…é¡»å®ç°çš„ä¸»è¦æ–¹æ³•ã€‚å®ƒæ¥å—è¾“å…¥è®°å½•å¹¶è¿”å›è¾“å‡ºè®°å½•ã€‚æ¥æ”¶åˆ°çš„è¾“å…¥åº”ç¬¦åˆ
inputKeys
æ•°ç»„ï¼Œè¿”å›çš„è¾“å‡ºåº”ç¬¦åˆ
outputKeys
æ•°ç»„ã€‚
åœ¨è‡ªå®šä¹‰é“¾ä¸­å®ç°æ­¤æ–¹æ³•æ—¶ï¼Œå€¼å¾—ç‰¹åˆ«å…³æ³¨çš„æ˜¯
runManager
å‚æ•°ï¼Œå®ƒå…è®¸æ‚¨çš„è‡ªå®šä¹‰é“¾å‚ä¸ä¸å†…ç½®é“¾ç›¸åŒçš„å›è°ƒç³»ç»Ÿ
callbacks system
ã€‚
å¦‚æœåœ¨è‡ªå®šä¹‰é“¾ä¸­è°ƒç”¨å¦ä¸€ä¸ªé“¾/æ¨¡å‹/ä»£ç†ï¼Œåˆ™åº”å°†å…¶ä¼ é€’ç»™è°ƒç”¨
runManagerï¼Ÿ.getChildï¼ˆ)
çš„ç»“æœï¼Œè¯¥ç»“æœå°†ç”Ÿæˆä¸€ä¸ªæ–°çš„å›è°ƒç®¡ç†å™¨ï¼ŒèŒƒå›´é™å®šä¸ºè¯¥å†…éƒ¨è¿è¡Œã€‚ä¾‹å¦‚:
import
{
BasePromptTemplate
,
PromptTemplate
}
from
"langchain/prompts"
;
import
{
BaseLanguageModel
}
from
"langchain/base_language"
;
import
{
CallbackManagerForChainRun
}
from
"langchain/callbacks"
;
import
{
BaseChain
,
ChainInputs
}
from
"langchain/chains"
;
import
{
ChainValues
}
from
"langchain/schema"
;
export
interface
MyCustomChainInputs
extends
ChainInputs
{
llm
:
BaseLanguageModel
;
promptTemplate
:
string
;
}
export
class
MyCustomChain
extends
BaseChain
implements
MyCustomChainInputs
{
llm
:
BaseLanguageModel
;
promptTemplate
:
string
;
prompt
:
BasePromptTemplate
;
constructor
(
fields
:
MyCustomChainInputs
)
{
super
(
fields
)
;
this
.
llm
=
fields
.
llm
;
this
.
promptTemplate
=
fields
.
promptTemplate
;
this
.
prompt
=
PromptTemplate
.
fromTemplate
(
this
.
promptTemplate
)
;
}
async
_call
(
values
:
ChainValues
,
runManager
?
:
CallbackManagerForChainRun
)
:
Promise
<
ChainValues
>
{
// Your custom chain logic goes here
// This is just an example that mimics LLMChain
const
promptValue
=
await
this
.
prompt
.
formatPromptValue
(
values
)
;
// Whenever you call a language model, or another chain, you should pass
// a callback manager to it. This allows the inner run to be tracked by
// any callbacks that are registered on the outer run.
// You can always obtain a callback manager for this by calling
// `runManager?.getChild()` as shown below.
const
result
=
await
this
.
llm
.
generatePrompt
(
[
promptValue
]
,
{
}
,
runManager
?.
getChild
(
)
)
;
// If you want to log something about this run, you can do so by calling
// methods on the runManager, as shown below. This will trigger any
// callbacks that are registered for that event.
runManager
?.
handleText
(
"Log something about this run"
)
;
return
{
output
:
result
.
generations
[
0
]
[
0
]
.
text
}
;
}
_chainType
(
)
:
string
{
return
"my_custom_chain"
;
}
get
inputKeys
(
)
:
string
[
]
{
return
[
"input"
]
;
}
get
outputKeys
(
)
:
string
[
]
{
return
[
"output"
]
;
}
}